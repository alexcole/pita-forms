(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     12142,        317]
NotebookOptionsPosition[     11732,        299]
NotebookOutlinePosition[     12167,        316]
CellTagsIndexPosition[     12124,        313]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"angle", "[", "l_", "]"}], ":=", 
  RowBox[{"VectorAngle", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"l", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "-", 
     RowBox[{"l", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"l", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "-", 
     RowBox[{"l", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newpt", "[", 
   RowBox[{"base_", ",", "oldspiral_", ",", "th_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"I", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Arg", "[", "oldspiral", "]"}], "+", "th"}], ")"}]}], "]"}], 
   "d"}]}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pts", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", "Pi", " ", 
           RowBox[{"t", "/", "n"}]}], "]"}], ",", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "Pi", " ", 
           RowBox[{"t", "/", "n"}]}], "]"}], ",", 
         RowBox[{"h", " ", 
          RowBox[{"t", "/", "n"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"surface", "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "i", ",", 
           RowBox[{"i", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"n", "-", "i", "+", "1"}], ",", 
           RowBox[{"n", "-", "i"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"flatsurface", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "i", ",", " ", 
           RowBox[{"i", "+", "1"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "2", ",", " ", "n"}], "}"}]}], "]"}], ",", 
       " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "+", "2"}], ",", " ", 
           RowBox[{"n", "+", "2", "+", "i"}], ",", " ", 
           RowBox[{"n", "+", "3", "+", "i"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"surfacepts", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pts", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "surface", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"unfoldhalf", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Re", "[", "#", "]"}]}], ",", 
            RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"FoldList", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newpt", "[", 
             RowBox[{"0", ",", "#1", ",", 
              RowBox[{"angle", "[", 
               RowBox[{"surfacepts", "[", 
                RowBox[{"[", "#2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"EuclideanDistance", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"surfacepts", "[", 
                  RowBox[{"[", "#2", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"surfacepts", "[", 
                  RowBox[{"[", "#2", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"surfacepts", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"surfacepts", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}], "//", "N"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"unfold", " ", "=", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"unfoldhalf", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"unfoldhalf", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "+", "#"}], ")"}], "&"}], "/@", 
          RowBox[{"-", "unfoldhalf"}]}]}], "}"}], ",", " ", "1"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"flatsurfacepts", " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"unfold", "[", 
         RowBox[{"[", "#", "]"}], "]"}], " ", "&"}], ",", " ", "flatsurface", 
       ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"Polygon", "[", "surfacepts", "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", "Pink", ",", " ", 
         RowBox[{"Polygon", "[", "flatsurfacepts", "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "10", ",", "200", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", "1", ",", "17", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.562007871191539*^9, 3.562008082600761*^9}, {
   3.5620081159356737`*^9, 3.5620081813349953`*^9}, {3.56200822109051*^9, 
   3.562008258875235*^9}, {3.56200831367351*^9, 3.562008319039966*^9}, {
   3.5620085345840483`*^9, 3.562008549061347*^9}, {3.562009154492038*^9, 
   3.56200915638338*^9}, {3.562009395118073*^9, 3.562009403431786*^9}, 
   3.562010027457947*^9, {3.562010302092183*^9, 3.562010302974454*^9}, 
   3.5620103363581257`*^9, {3.562010378463623*^9, 3.5620104872848186`*^9}, {
   3.56201059155335*^9, 3.5620108032982683`*^9}, {3.562010839743833*^9, 
   3.56201088243581*^9}, {3.5653919517461777`*^9, 3.5653919550174847`*^9}, {
   3.565393261139474*^9, 3.5653932787409973`*^9}, 3.5653933509003773`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`h$$ = 1, $CellContext`n$$ = 10, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 10, 200, 10}, {
      Hold[$CellContext`h$$], 1, 17, 1}}, Typeset`size$$ = {
    723., {196., 200.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`n$2261$$ = 
    0, $CellContext`h$2262$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`h$$ = 1, $CellContext`n$$ = 10}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$2261$$, 0], 
        Hold[$CellContext`h$$, $CellContext`h$2262$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`pts = Table[{
           Cos[(2 Pi) ($CellContext`t/$CellContext`n$$)], 
           
           Sin[(2 Pi) ($CellContext`t/$CellContext`n$$)], $CellContext`h$$ \
($CellContext`t/$CellContext`n$$)}, {$CellContext`t, 
           0, $CellContext`n$$}]; $CellContext`surface = Join[
          
          Table[{1, $CellContext`i, $CellContext`i + 1}, {$CellContext`i, 
            2, $CellContext`n$$}], 
          
          Table[{$CellContext`n$$ + 1, $CellContext`n$$ - $CellContext`i + 
            1, $CellContext`n$$ - $CellContext`i}, {$CellContext`i, 
            1, $CellContext`n$$ - 1}]]; $CellContext`flatsurface = Join[
          
          Table[{1, $CellContext`i, $CellContext`i + 1}, {$CellContext`i, 
            2, $CellContext`n$$}], 
          
          Table[{$CellContext`n$$ + 2, $CellContext`n$$ + 
            2 + $CellContext`i, $CellContext`n$$ + 
            3 + $CellContext`i}, {$CellContext`i, 1, $CellContext`n$$ - 
            1}]]; $CellContext`surfacepts = 
        Map[Part[$CellContext`pts, #]& , $CellContext`surface, {
          2}]; $CellContext`unfoldhalf = Join[{{0, 0}}, 
          N[
           Map[{-Re[#], 
             Im[#]}& , 
            FoldList[$CellContext`newpt[0, #, 
              $CellContext`angle[
               Part[$CellContext`surfacepts, #2]], 
              EuclideanDistance[
               Part[
                Part[$CellContext`surfacepts, #2], 1], 
               Part[
                Part[$CellContext`surfacepts, #2], 3]]]& , 
             EuclideanDistance[
              Part[
               Part[$CellContext`surfacepts, 1], 2], 
              Part[
               Part[$CellContext`surfacepts, 1], 3]], 
             Range[1, $CellContext`n$$ - 1]]]]]; $CellContext`unfold = 
        Flatten[{$CellContext`unfoldhalf, 
           Map[
           Part[$CellContext`unfoldhalf, -1] + #& , \
-$CellContext`unfoldhalf]}, 1]; $CellContext`flatsurfacepts = 
        Map[Part[$CellContext`unfold, #]& , $CellContext`flatsurface, {2}]; 
       Graphics3D[
          Polygon[$CellContext`surfacepts], ImageSize -> Medium] Graphics[{
           EdgeForm[Thin], Pink, 
           Polygon[$CellContext`flatsurfacepts]}, ImageSize -> Medium]), 
      "Specifications" :> {{$CellContext`n$$, 10, 200, 10}, {$CellContext`h$$,
          1, 17, 1}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{768., {254., 259.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.565393280710404*^9, 3.565393351823638*^9}]
}, Open  ]]
},
WindowSize->{1169, 856},
WindowMargins->{{99, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 20, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 7201, 189, 335, "Input"],
Cell[7783, 213, 3933, 83, 530, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
